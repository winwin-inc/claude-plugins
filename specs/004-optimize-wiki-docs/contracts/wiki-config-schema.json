{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://repo-wiki.dev/schemas/wiki-config-schema.json",
  "title": "Wiki Generator Configuration Schema",
  "description": "配置文件 schema，用于验证 .claude/wiki-config.json",
  "type": "object",
  "required": ["language", "structure_template"],
  "properties": {
    "output_dir": {
      "description": "文档输出目录",
      "type": "string",
      "minLength": 1,
      "pattern": "^[^<>:\"|?*]+$",
      "default": "docs"
    },
    "language": {
      "description": "文档语言",
      "type": "string",
      "enum": ["zh", "en", "both"],
      "default": "zh"
    },
    "structure_template": {
      "description": "文档结构模板",
      "type": "string",
      "enum": ["reference", "simple", "custom"],
      "default": "reference"
    },
    "include_sources": {
      "description": "是否包含 Section sources",
      "type": "boolean",
      "default": true
    },
    "generate_toc": {
      "description": "是否生成目录",
      "type": "boolean",
      "default": true
    },
    "sections": {
      "description": "文档章节配置",
      "type": "object",
      "properties": {
        "required": {
          "description": "必需文档列表",
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "quickstart",
              "overview",
              "techstack",
              "architecture",
              "datamodel",
              "corefeatures",
              "development",
              "deployment",
              "testing",
              "troubleshooting",
              "security"
            ]
          },
          "default": [
            "quickstart",
            "overview",
            "techstack",
            "architecture",
            "development",
            "deployment",
            "testing",
            "troubleshooting",
            "security"
          ]
        },
        "optional": {
          "description": "可选文档列表",
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "datamodel",
              "corefeatures"
            ]
          },
          "default": ["datamodel", "corefeatures"]
        }
      }
    },
    "formatting": {
      "description": "格式化配置",
      "type": "object",
      "properties": {
        "code_block_syntax": {
          "description": "代码块语法高亮",
          "type": "boolean",
          "default": true
        },
        "line_numbers": {
          "description": "是否显示行号",
          "type": "boolean",
          "default": true
        },
        "section_sources": {
          "description": "是否显示章节来源",
          "type": "boolean",
          "default": true
        }
      },
      "default": {
        "code_block_syntax": true,
        "line_numbers": true,
        "section_sources": true
      }
    },
    "links": {
      "description": "链接配置",
      "type": "object",
      "properties": {
        "auto_generate": {
          "description": "是否自动生成链接",
          "type": "boolean",
          "default": true
        },
        "validate": {
          "description": "是否验证链接",
          "type": "boolean",
          "default": true
        }
      },
      "default": {
        "auto_generate": true,
        "validate": true
      }
    },
    "performance": {
      "description": "性能配置",
      "type": "object",
      "properties": {
        "batch_size": {
          "description": "批处理大小",
          "type": "integer",
          "minimum": 1,
          "maximum": 1000,
          "default": 50
        },
        "max_workers": {
          "description": "最大并发数（预留，当前使用单线程）",
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 1
        },
        "cache_templates": {
          "description": "是否缓存模板",
          "type": "boolean",
          "default": true
        }
      },
      "default": {
        "batch_size": 50,
        "max_workers": 1,
        "cache_templates": true
      }
    }
  },
  "if": {
    "properties": {
      "structure_template": {
        "const": "custom"
      }
    },
    "required": ["structure_template"]
  },
  "then": {
    "required": ["sections"]
  },
  "definitions": {
    "documentTypes": {
      "type": "string",
      "enum": [
        "quickstart",
        "overview",
        "techstack",
        "architecture",
        "datamodel",
        "corefeatures",
        "development",
        "deployment",
        "testing",
        "troubleshooting",
        "security"
      ]
    }
  }
}
